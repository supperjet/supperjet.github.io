<!DOCTYPE html>
<html>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="上一节中我们介绍了三角函数的应用，通过三角函数我们让小球实现了平滑运动，线性运动，圆周运动，脉冲运动等运动形式。这一节，我们介绍表征物体运动状态的另一个物理量——速度。 1.速度与速率速度表征物体运动的快慢。在讲解速度与速率的概念之前，我们需要了解两个数学上的概念：矢量与标量 标量：有大小而没有方向的物理量（速率，体积，温度）矢量：有大小也有方向的物理量（速度，动量，力） 尽管我们平时很少区分速">
<meta name="keywords" content="canvas">
<meta property="og:type" content="article">
<meta property="og:title" content="每周一点canvas动画--速度">
<meta property="og:url" content="http://yoursite.com/2017/08/18/每周一点canvas动画-速度/index.html">
<meta property="og:site_name" content="一只会飞的鱼">
<meta property="og:description" content="上一节中我们介绍了三角函数的应用，通过三角函数我们让小球实现了平滑运动，线性运动，圆周运动，脉冲运动等运动形式。这一节，我们介绍表征物体运动状态的另一个物理量——速度。 1.速度与速率速度表征物体运动的快慢。在讲解速度与速率的概念之前，我们需要了解两个数学上的概念：矢量与标量 标量：有大小而没有方向的物理量（速率，体积，温度）矢量：有大小也有方向的物理量（速度，动量，力） 尽管我们平时很少区分速">
<meta property="og:image" content="http://zyf-img.oss-cn-beijing.aliyuncs.com/Myblog%2Fpic%2Fspeed.jpg?OSSAccessKeyId=LTAIkU9IYC0zIU2B&Expires=1863018030&Signature=1gpSTAh4u9WSKOKhgkotRdKzbOM%3D">
<meta property="og:image" content="http://zyf-img.oss-cn-beijing.aliyuncs.com/Myblog%2Fpic%2Fspeed1.PNG?OSSAccessKeyId=LTAIkU9IYC0zIU2B&Expires=1863018150&Signature=AsXza6ngiXnSb0ZNCNXhxYM9904%3D">
<meta property="og:image" content="http://zyf-img.oss-cn-beijing.aliyuncs.com/Myblog%2Fpic%2Fspeed2.gif?OSSAccessKeyId=LTAIkU9IYC0zIU2B&Expires=1863018199&Signature=eqWMRTnlpP4Xy6bNWuIJ0Px8pTQ%3D">
<meta property="og:image" content="http://zyf-img.oss-cn-beijing.aliyuncs.com/Myblog%2Fpic%2Fspeed3.gif?OSSAccessKeyId=LTAIkU9IYC0zIU2B&Expires=1863018246&Signature=F4Rg8Q2TIH42w9S%2FYUDd7W0tV9E%3D">
<meta property="og:image" content="http://zyf-img.oss-cn-beijing.aliyuncs.com/Myblog%2Fpic%2Fspeed4.PNG?OSSAccessKeyId=LTAIkU9IYC0zIU2B&Expires=1863018289&Signature=25%2BbCdS5q1iEeVkClhWoAQdm1Qo%3D">
<meta property="og:image" content="http://zyf-img.oss-cn-beijing.aliyuncs.com/Myblog%2Fpic%2Fspeed5.PNG?OSSAccessKeyId=LTAIkU9IYC0zIU2B&Expires=1863018335&Signature=4o6WdDUdH1OBP7DCNo5UNWJVPzA%3D">
<meta property="og:image" content="http://zyf-img.oss-cn-beijing.aliyuncs.com/Myblog%2Fpic%2Fspeed6.PNG?OSSAccessKeyId=LTAIkU9IYC0zIU2B&Expires=1863018393&Signature=C39hdqLDkBBBPg7OCnDZi3B4JtM%3D">
<meta property="og:image" content="http://zyf-img.oss-cn-beijing.aliyuncs.com/Myblog%2Fpic%2Fspeed7.gif?OSSAccessKeyId=LTAIkU9IYC0zIU2B&Expires=1863018433&Signature=ckQMQgJIXtm%2FmTUaf32MLWrTAjo%3D">
<meta property="og:updated_time" content="2017-08-18T01:08:49.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="每周一点canvas动画--速度">
<meta name="twitter:description" content="上一节中我们介绍了三角函数的应用，通过三角函数我们让小球实现了平滑运动，线性运动，圆周运动，脉冲运动等运动形式。这一节，我们介绍表征物体运动状态的另一个物理量——速度。 1.速度与速率速度表征物体运动的快慢。在讲解速度与速率的概念之前，我们需要了解两个数学上的概念：矢量与标量 标量：有大小而没有方向的物理量（速率，体积，温度）矢量：有大小也有方向的物理量（速度，动量，力） 尽管我们平时很少区分速">
<meta name="twitter:image" content="http://zyf-img.oss-cn-beijing.aliyuncs.com/Myblog%2Fpic%2Fspeed.jpg?OSSAccessKeyId=LTAIkU9IYC0zIU2B&Expires=1863018030&Signature=1gpSTAh4u9WSKOKhgkotRdKzbOM%3D">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>每周一点canvas动画--速度</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/supperjet">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/2017/08/17/每周一点canvas动画-圆周运动/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/&text=每周一点canvas动画--速度"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/&title=每周一点canvas动画--速度"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/&is_video=false&description=每周一点canvas动画--速度"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=每周一点canvas动画--速度&body=Check out this article: http://yoursite.com/2017/08/18/每周一点canvas动画-速度/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/&title=每周一点canvas动画--速度"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/&title=每周一点canvas动画--速度"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/&title=每周一点canvas动画--速度"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/&title=每周一点canvas动画--速度"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/&name=每周一点canvas动画--速度&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-速度与速率"><span class="toc-number">1.</span> <span class="toc-text">1.速度与速率</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-坐标轴方向的运动"><span class="toc-number">2.</span> <span class="toc-text">2.坐标轴方向的运动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-任意方向的速度"><span class="toc-number">3.</span> <span class="toc-text">3.任意方向的速度</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-鼠标跟随"><span class="toc-number">4.</span> <span class="toc-text">3.鼠标跟随</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-扩展"><span class="toc-number">5.</span> <span class="toc-text">4.扩展</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        每周一点canvas动画--速度
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">一只会飞的鱼</span>
      </span>
      
    <div class="postdate">
        <time datetime="2017-08-18T00:57:46.000Z" itemprop="datePublished">2017-08-18</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/canvas/">canvas</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p><img src="http://zyf-img.oss-cn-beijing.aliyuncs.com/Myblog%2Fpic%2Fspeed.jpg?OSSAccessKeyId=LTAIkU9IYC0zIU2B&amp;Expires=1863018030&amp;Signature=1gpSTAh4u9WSKOKhgkotRdKzbOM%3D" alt=""></p>
<p>上一节中我们介绍了三角函数的应用，通过三角函数我们让小球实现了<code>平滑运动</code>，<code>线性运动</code>，<code>圆周运动</code>，<code>脉冲运动</code>等运动形式。这一节，我们介绍表征物体运动状态的另一个物理量——<code>速度</code>。</p>
<h2 id="1-速度与速率"><a href="#1-速度与速率" class="headerlink" title="1.速度与速率"></a>1.速度与速率</h2><p><strong>速度表征物体运动的快慢</strong>。在讲解速度与速率的概念之前，我们需要了解两个数学上的概念：<code>矢量与标量</code></p>
<p><strong>标量</strong>：有大小而没有方向的物理量（速率，体积，温度）<br><strong>矢量</strong>：有大小也有方向的物理量（速度，动量，力）</p>
<p>尽管我们平时很少区分速度和速率到底有怎样的区别。但在我们的程序中基本上用到的都是<code>速度</code>的概念。所以，你只需要记住我们用的这个变量既有数值大小也有方向就行了。</p>
<p><img src="http://zyf-img.oss-cn-beijing.aliyuncs.com/Myblog%2Fpic%2Fspeed1.PNG?OSSAccessKeyId=LTAIkU9IYC0zIU2B&amp;Expires=1863018150&amp;Signature=AsXza6ngiXnSb0ZNCNXhxYM9904%3D" alt=""></p>
<p>在上图中我们定义了两个速度v1和v2，它们具有相同的大小，但是方向却不相同，所以他们是完全不同的两个速度。</p>
<h2 id="2-坐标轴方向的运动"><a href="#2-坐标轴方向的运动" class="headerlink" title="2.坐标轴方向的运动"></a>2.坐标轴方向的运动</h2><p>简单的介绍完速度的概念，那么怎样把它运用在我们的动画中呢？比如，现在我要让小球沿着X轴的方向以速度为1做匀速运动，直观的感受是小球的位置不停的在发生变化，也就是说，速度其实作用在了小球的x坐标上。具体代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">&lt;canvas id=<span class="string">"canvas"</span> width=<span class="string">"500"</span> height=<span class="string">"500"</span> style=<span class="string">"background:#000;"</span>&gt;</div><div class="line">    your browser not support canvas</div><div class="line">&lt;<span class="regexp">/canvas&gt;</span></div><div class="line"><span class="regexp">&lt;script src="../</span>js/ball.js<span class="string">"&gt;&lt;/script&gt;</span></div><div class="line"><span class="string">&lt;script src="</span>../js/utils.js<span class="string">"&gt;&lt;/script&gt;</span></div><div class="line"><span class="string">&lt;script&gt;</span></div><div class="line"><span class="string">    window.onload = function()&#123;</span></div><div class="line"><span class="string">        var canvas = document.getElementById('canvas');</span></div><div class="line"><span class="string">        var context = canvas.getContext('2d');</span></div><div class="line"><span class="string">        </span></div><div class="line"><span class="string">        var ball = new Ball();</span></div><div class="line"><span class="string">            ball.x = canvas.width/4;</span></div><div class="line"><span class="string">            ball.y = canvas.height/4;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">        var vx = 1; //定义速度</span></div><div class="line"><span class="string">        </span></div><div class="line"><span class="string">        //动画循环</span></div><div class="line"><span class="string">        (function drawFrame()&#123;</span></div><div class="line"><span class="string">            window.requestAnimationFrame(drawFrame, canvas);</span></div><div class="line"><span class="string">            context.clearRect(0, 0, canvas.width, canvas.height);</span></div><div class="line"><span class="string">            </span></div><div class="line"><span class="string">            ball.x += vx; // 在每一帧中都让小球的位置加上速度</span></div><div class="line"><span class="string">            </span></div><div class="line"><span class="string">            ball.draw(context);</span></div><div class="line"><span class="string">        &#125;());</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">&lt;/script&gt;</span></div></pre></td></tr></table></figure>
<p>在上面的代码中，我们定义了一个速度vx，并在动画循环中让球的x轴坐标每一帧都加上一个初始的速度值！这样小球就会沿着x轴正方向做匀速运动！仔细观察你会发现，这其实就是你以前学习过的物理公式<code>s=vt</code>。至于 t 在哪？你可以想想。</p>
<p><img src="http://zyf-img.oss-cn-beijing.aliyuncs.com/Myblog%2Fpic%2Fspeed2.gif?OSSAccessKeyId=LTAIkU9IYC0zIU2B&amp;Expires=1863018199&amp;Signature=eqWMRTnlpP4Xy6bNWuIJ0Px8pTQ%3D" alt=""></p>
<p>同理，如果你想要让小球沿着Y轴正方向做匀速运动，只需要简单的定义一个水平方向的速度vy,然后，让小球的纵坐标值每帧都加上vy,就OK了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> vy = <span class="number">1</span>; <span class="comment">//定义速度</span></div><div class="line">ball.y += vy <span class="comment">// 在每一帧中都让小球的位置加上速度</span></div></pre></td></tr></table></figure>
<p><img src="http://zyf-img.oss-cn-beijing.aliyuncs.com/Myblog%2Fpic%2Fspeed3.gif?OSSAccessKeyId=LTAIkU9IYC0zIU2B&amp;Expires=1863018246&amp;Signature=F4Rg8Q2TIH42w9S%2FYUDd7W0tV9E%3D" alt=""></p>
<p>那么，如果同时在X轴和Y轴方向上定义了速度，并且分别作用于小球的X坐标和Y坐标，会是什么效果呢？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> vx = <span class="number">1</span>;</div><div class="line"><span class="keyword">var</span> vy = <span class="number">1</span>;</div><div class="line">...</div><div class="line">ball.x += vx;</div><div class="line">ball.y += vy；</div></pre></td></tr></table></figure>
<p><img src="http://zyf-img.oss-cn-beijing.aliyuncs.com/Myblog%2Fpic%2Fspeed4.PNG?OSSAccessKeyId=LTAIkU9IYC0zIU2B&amp;Expires=1863018289&amp;Signature=25%2BbCdS5q1iEeVkClhWoAQdm1Qo%3D" alt=""></p>
<p>我们可以看到小球既不沿着x轴也不沿着y轴运动，而是沿着一个45度角的方向在做运动。</p>
<h2 id="3-任意方向的速度"><a href="#3-任意方向的速度" class="headerlink" title="3.任意方向的速度"></a>3.任意方向的速度</h2><p>通过上面的代码演示，我们知道，当同时在一个物体的x轴和y轴上定义速度，那么物体的运动方向是这两个速度方向的<code>和方向</code>，即满足矢量的叠加，大小满足勾股定理。</p>
<p><img src="http://zyf-img.oss-cn-beijing.aliyuncs.com/Myblog%2Fpic%2Fspeed5.PNG?OSSAccessKeyId=LTAIkU9IYC0zIU2B&amp;Expires=1863018335&amp;Signature=4o6WdDUdH1OBP7DCNo5UNWJVPzA%3D" alt=""></p>
<p>图1和图2,分别在X轴和Y轴上定义了速度Vx和Vy,它们的合速度满足平行四边形规则，即图中的<code>V合</code>，我们可以看到合速度的大小满足勾股定理，而它的方向因为在坐标轴上的分量不相同，所以方向也不相同。至于第三幅图，其实跟前两幅图没什么区别，只是它的两个速度方向并不是沿着坐标轴。这与物理中力的合成与分解是一样的，在这我就不废话了。</p>
<p>既然，我们知道了可以通过控制沿坐标轴方向的速度来改变物体的运动方向和运行的快慢。想想在三角函数应用那一块，如果我们想要让小球做一个圆周运动，采用这种方法可行吗？</p>
<p>答案是绝对可以实现的！但是在圆周运动中，物体的运动方向时刻都在发生变化，如果你想要得到一个完美的圆周运动，就需要时刻改变X轴和Y轴的坐标值。我的天,这是多么大的工作量！所以，在那一章中们将<code>圆的直角坐标表达式</code>转化为<code>圆的参数方程</code>，为的就是找到更易于控制的元素。</p>
<p>那么现在，如果想要让小球按照我们指定的方向运动，该怎么办呢？答案当然是三角函数啦。。。，试想现在导演说：小球，你以每秒5米的速度，30度角方向运动。那么从中我们得到的信息量是，小球的合速度是5，方向是30度。那么把它分解到坐标轴上就是<code>vy = 2.5</code>,<code>vx = 4.33</code>。</p>
<p><img src="http://zyf-img.oss-cn-beijing.aliyuncs.com/Myblog%2Fpic%2Fspeed6.PNG?OSSAccessKeyId=LTAIkU9IYC0zIU2B&amp;Expires=1863018393&amp;Signature=C39hdqLDkBBBPg7OCnDZi3B4JtM%3D" alt=""></p>
<p>具体到代码如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="keyword">var</span> speed = <span class="number">5</span>;</div><div class="line"><span class="keyword">var</span> angle = <span class="number">30</span>;</div><div class="line">(<span class="function"><span class="keyword">function</span> <span class="title">drawFrame</span>(<span class="params"></span>)</span>&#123;</div><div class="line">               <span class="built_in">window</span>.requestAnimationFrame(drawFrame, canvas);</div><div class="line">               context.clearRect(<span class="number">0</span>, <span class="number">0</span>, canvas.width, canvas.height);</div><div class="line">               </div><div class="line">               <span class="comment">//将速度分解到X轴和Y轴，注意这里用的是弧度制，要乘上Math.PI/180</span></div><div class="line">               <span class="keyword">var</span> vx = <span class="built_in">Math</span>.cos(angles*<span class="built_in">Math</span>.PI/<span class="number">180</span>)*speed;</div><div class="line">               <span class="keyword">var</span> vy = <span class="built_in">Math</span>.sin(angles*<span class="built_in">Math</span>.PI/<span class="number">180</span>)*speed;</div><div class="line">               </div><div class="line">               <span class="comment">//坐标位置每一帧都加上速度</span></div><div class="line">               ball.x += vx;</div><div class="line">               ball.y += vy;</div><div class="line">               ball.draw(context);</div><div class="line">           &#125;())</div></pre></td></tr></table></figure>
<p>在代码中我们直接定义了物体的运行速度，和运行的方向。然后在动画循环中通过三角函数动态的去计算每一帧在x轴和Y轴上应该移动的距离。</p>
<h2 id="3-鼠标跟随"><a href="#3-鼠标跟随" class="headerlink" title="3.鼠标跟随"></a>3.鼠标跟随</h2><p>了解了上面的知识，现在我们来模拟一个很炫酷的动画。我叫它<code>鼠标跟随</code>，它实现的效果就是让物体跟着鼠标移动，每当你改变鼠标的位置，物体就会改变它的运动方向，并朝着鼠标的方向移动作匀速移动。还记得我们在三角函数那一章结尾的运用实例吗？在那个实例中我们做了一个跟随鼠标旋转的箭头，今天我们做的这个鼠标跟随的效果就是在此基础上，运用本章所学内容的一个改进。</p>
<p><img src="http://zyf-img.oss-cn-beijing.aliyuncs.com/Myblog%2Fpic%2Fspeed7.gif?OSSAccessKeyId=LTAIkU9IYC0zIU2B&amp;Expires=1863018433&amp;Signature=ckQMQgJIXtm%2FmTUaf32MLWrTAjo%3D" alt=""></p>
<p>具体代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">&lt;canvas id=<span class="string">"canvas"</span> style=<span class="string">"background:#000;"</span> width=<span class="string">"500"</span> height=<span class="string">"500"</span>&gt;</div><div class="line">       you browser not support canvas</div><div class="line">   &lt;<span class="regexp">/canvas&gt;</span></div><div class="line"><span class="regexp">   &lt;script src="../</span>js/arrow.js<span class="string">"&gt;&lt;/script&gt;</span></div><div class="line"><span class="string">   &lt;script src="</span>../js/utils.js<span class="string">"&gt;&lt;/script&gt;</span></div><div class="line"><span class="string">   &lt;script&gt;</span></div><div class="line"><span class="string">       window.onload = function()&#123;</span></div><div class="line"><span class="string">           var canvas = document.getElementById("</span>canvas<span class="string">");</span></div><div class="line"><span class="string">           var context = canvas.getContext("</span><span class="number">2</span>d<span class="string">");</span></div><div class="line"><span class="string">           //获取鼠标相对canvas的位置</span></div><div class="line"><span class="string">           var mouse = utils.captureMouse(canvas);</span></div><div class="line"><span class="string">           </span></div><div class="line"><span class="string">           var arrow = new Arrow();</span></div><div class="line"><span class="string">           arrow.x = canvas.width/2;</span></div><div class="line"><span class="string">           arrow.y = canvas.height/2;</span></div><div class="line"><span class="string">           </span></div><div class="line"><span class="string">           var angle = 0, speed = 2; //定义速度和方向</span></div><div class="line"><span class="string">           </span></div><div class="line"><span class="string">           (function drawFrame()&#123;</span></div><div class="line"><span class="string">               window.requestAnimationFrame(drawFrame, canvas);</span></div><div class="line"><span class="string">               context.clearRect(0,0,canvas.width,canvas.height);</span></div><div class="line"><span class="string">               </span></div><div class="line"><span class="string">               //这点看不懂的话，就去复习一下吧，我们要用它来计算角度</span></div><div class="line"><span class="string">               var dx = mouse.x - arrow.x; </span></div><div class="line"><span class="string">               var dy = mouse.y - arrow.y; </span></div><div class="line"><span class="string">               </span></div><div class="line"><span class="string">               //得到角度值</span></div><div class="line"><span class="string">               angle = Math.atan2(dy, dx);</span></div><div class="line"><span class="string">               </span></div><div class="line"><span class="string">               //箭头旋转</span></div><div class="line"><span class="string">               arrow.rotation = angle;//angle默认为弧度</span></div><div class="line"><span class="string">               </span></div><div class="line"><span class="string">               //将速度分解</span></div><div class="line"><span class="string">               var vx = Math.cos(angle)*speed;</span></div><div class="line"><span class="string">               var vy = Math.sin(angle)*speed;</span></div><div class="line"><span class="string">               </span></div><div class="line"><span class="string">               //移动</span></div><div class="line"><span class="string">               arrow.x += vx;</span></div><div class="line"><span class="string">               arrow.y += vy;</span></div><div class="line"><span class="string">               //绘制</span></div><div class="line"><span class="string">               arrow.draw(context);</span></div><div class="line"><span class="string">           &#125;());</span></div><div class="line"><span class="string">       &#125;</span></div><div class="line"><span class="string">    &lt;/script&gt;</span></div></pre></td></tr></table></figure>
<p>这里我们首先初始化好速度和角度，然后将鼠标的坐标值减去箭头的坐标位置，得到dx,dy, 然后运用Math.atan2()得到角度值(通过此方法得到的是弧度制的角度)，最后运用三角函数将速度分解到x和y方向。</p>
<h2 id="4-扩展"><a href="#4-扩展" class="headerlink" title="4.扩展"></a>4.扩展</h2><p>前面我们介绍了怎样通过三角函数来实现任意方向的速度。那么还有其他的方法改变物体的运动方向吗，在这部分中我们介绍一个扩展方法，他运用的是canvas的rotation()方法，具体代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">           <span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">"canvas"</span>);</div><div class="line">           <span class="keyword">var</span> context = canvas.getContext(<span class="string">"2d"</span>);</div><div class="line">           </div><div class="line">           <span class="keyword">var</span> arrow = <span class="keyword">new</span> Arrow();</div><div class="line">           arrow.x = canvas.width/<span class="number">2</span>;</div><div class="line">           arrow.y = canvas.height/<span class="number">2</span>;</div><div class="line">           </div><div class="line">           <span class="keyword">var</span> vr = <span class="number">30</span>, speed = <span class="number">2</span>;</div><div class="line">           </div><div class="line">           (<span class="function"><span class="keyword">function</span> <span class="title">drawFrame</span>(<span class="params"></span>)</span>&#123;</div><div class="line">               <span class="built_in">window</span>.requestAnimationFrame(drawFrame, canvas);</div><div class="line">               context.clearRect(<span class="number">0</span>,<span class="number">0</span>,canvas.width,canvas.height);</div><div class="line">               </div><div class="line">               <span class="comment">//通过rotation来改变角度值</span></div><div class="line">               arrow.rotation = vr*<span class="built_in">Math</span>.PI/<span class="number">180</span>;</div><div class="line">               <span class="comment">//分解</span></div><div class="line">               arrow.x += <span class="built_in">Math</span>.cos(arrow.rotation)*speed;</div><div class="line">               arrow.y += <span class="built_in">Math</span>.sin(arrow.rotation)*speed;</div><div class="line">               </div><div class="line">               arrow.draw(context);</div><div class="line">           &#125;())</div><div class="line">       &#125;</div></pre></td></tr></table></figure>
<p>这里我们通过改变箭头的rotation属性来定义方向，然后其他的都是一样的将速度分解到x方向和y方向，坐标位置改变等。</p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/supperjet">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-速度与速率"><span class="toc-number">1.</span> <span class="toc-text">1.速度与速率</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-坐标轴方向的运动"><span class="toc-number">2.</span> <span class="toc-text">2.坐标轴方向的运动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-任意方向的速度"><span class="toc-number">3.</span> <span class="toc-text">3.任意方向的速度</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-鼠标跟随"><span class="toc-number">4.</span> <span class="toc-text">3.鼠标跟随</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-扩展"><span class="toc-number">5.</span> <span class="toc-text">4.扩展</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/&text=每周一点canvas动画--速度"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/&title=每周一点canvas动画--速度"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/&is_video=false&description=每周一点canvas动画--速度"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=每周一点canvas动画--速度&body=Check out this article: http://yoursite.com/2017/08/18/每周一点canvas动画-速度/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/&title=每周一点canvas动画--速度"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/&title=每周一点canvas动画--速度"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/&title=每周一点canvas动画--速度"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/&title=每周一点canvas动画--速度"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2017/08/18/每周一点canvas动画-速度/&name=每周一点canvas动画--速度&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2017 zhouyufei
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/supperjet">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">


<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-86660611-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->


